Thanks to PhilKes for sharing his code. I modified it to fit my needs.
